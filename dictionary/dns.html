<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />

  <title>DNS (Domain Name System) | Network Packet Dictionary</title>
  <meta name="description" content="DNS (Domain Name System) explained: purpose, layer placement, message fields overview, typical flow, Wireshark appearance, and common troubleshooting patterns." />
  <meta name="robots" content="index,follow" />

  <link rel="stylesheet" href="/assets/css/styles.css" />

  <!-- Dictionary P0 v1.3: SAFE SCOPE (ONLY inside <article class="content">) -->
  <style>
    /* Wireshark filter block (scoped) */
    .content pre.ws-filter{
      margin:0.4em 0 1em;
      padding:0.6em 0.8em;
      border-radius:8px;
      background:rgba(0,0,0,0.06);
      border:1px solid rgba(0,0,0,0.10);
      overflow-x:auto;
    }
    .content pre.ws-filter code{
      background:none;
      padding:0;
      border:none;
      font-size:0.95em;
      user-select:text;
      font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;
    }

    /* Issues readability (scoped) */
    .content h3{
      font-size:1.2em;
      font-weight:900;
      margin-top:1.6em;
      margin-bottom:0.45em;
    }
    .content dl.issue{
      margin:0.6em 0 1.4em;
      padding:0.9em 1em;
      border-radius:10px;
      background:rgba(0,0,0,0.04);
      border:1px solid rgba(0,0,0,0.08);
    }
    .content dl.issue dt{
      font-weight:900;
      margin-top:0.65em;
    }
    .content dl.issue dt:first-child{
      margin-top:0;
    }
    .content dl.issue dd{
      margin:0.2em 0 0.45em;
      opacity:0.95;
      line-height:1.65;
    }
    .content dl.issue dd + dt{
      margin-top:0.75em;
    }

    /* Ordered list emphasis (scoped) */
    .content ol{ margin:0.6em 0 1.2em; padding-left:1.4em; }
    .content ol li{ margin:0.4em 0; line-height:1.6; }
    .content ol li::marker{ font-weight:900; }
  </style>

  <!-- v1.3 rule: AdSense script must NOT be embedded in dictionary pages -->
   <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5493851170081090"
     crossorigin="anonymous"></script>
</head>

<body data-ads="on">
  <header class="header">
    <div class="header-inner">
      <a class="brand" href="/">
        <div class="logo"></div>
        <div>
          <div class="brand-title">Network Packet Dictionary</div>
        </div>
      </a>
      <nav class="nav" aria-label="Site">
        <a href="/dictionary.html">Dictionary</a>
        <a href="/fields.html">Fields</a>
        <a href="/topics.html">Topics</a>
        <a href="/tools.html">Tools</a>
        <a href="/about.html">About</a>
      </nav>
    </div>
  </header>

  <main class="wrap">
    <section class="card">

      <!-- Ad slot (top) -->
      <div class="ad">Ad slot (dictionary-top)</div>

      <article class="content">
        <h1>DNS (Domain Name System)</h1>

        <h2>What it is (Definition)</h2>
        <p>
          DNS is the naming system that maps human-friendly names (like <em>example.com</em>) to network information such as
          IP addresses. Most users experience DNS as “the thing that must work for the internet to feel alive.” When DNS
          resolution fails, web pages, APIs, and many apps appear broken even if the underlying IP connectivity is fine.
        </p>
        <p>
          DNS is distributed and hierarchical. Clients usually ask a recursive resolver (often provided by an ISP, enterprise
          network, or public service). The resolver may query authoritative servers, cache results, and return answers with
          a time-to-live (TTL) that determines how long they can be reused.
        </p>

        <h2>Where it sits in the stack (Layer &amp; usage)</h2>
        <p><span class="badge">L7</span> DNS is an application-layer protocol (commonly over UDP and sometimes TCP).</p>
        <ul>
          <li><strong>Transport:</strong> UDP/53 for most queries; TCP/53 for large responses, zone transfers, or retries.</li>
          <li><strong>Used by:</strong> Web browsing, email routing, service discovery, and many internal enterprise systems.</li>
          <li><strong>Where seen:</strong> Client ↔ recursive resolver, resolver ↔ authoritative servers, caches everywhere.</li>
        </ul>
        <p>
          Modern variants also exist: DNS over TLS (DoT) and DNS over HTTPS (DoH) encrypt DNS queries. But classic DNS over
          UDP/53 remains widespread and is the common focus in packet analysis.
        </p>

        <h2>Header overview (Fields at a glance)</h2>
        <p>
          DNS messages are structured as a header plus sections: Question, Answer, Authority, and Additional. The header has
          a transaction ID to match responses to requests and flags that describe query/response behavior.
        </p>

        <table>
          <thead>
            <tr>
              <th>Field</th>
              <th>Size</th>
              <th>Purpose</th>
              <th>Common values / notes</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Transaction ID</td>
              <td>2 bytes</td>
              <td>Matches response to query</td>
              <td>Key for correlating in captures</td>
            </tr>
            <tr>
              <td>Flags</td>
              <td>2 bytes</td>
              <td>Query/response metadata</td>
              <td>QR, RD, RA, AA, TC; “NoError”, “NXDOMAIN” in response code</td>
            </tr>
            <tr>
              <td>QDCOUNT</td>
              <td>2 bytes</td>
              <td>Number of questions</td>
              <td>Usually 1 for typical client queries</td>
            </tr>
            <tr>
              <td>ANCOUNT / NSCOUNT / ARCOUNT</td>
              <td>2 bytes each</td>
              <td>Counts for sections</td>
              <td>Helps spot empty answers vs referrals</td>
            </tr>
            <tr>
              <td>Question section</td>
              <td>variable</td>
              <td>Name/type being asked</td>
              <td>A/AAAA/CNAME/TXT and more; includes QNAME, QTYPE, QCLASS</td>
            </tr>
            <tr>
              <td>Resource Records</td>
              <td>variable</td>
              <td>Answers and related data</td>
              <td>Includes TTL and RDATA; avoid full value lists here—Fields page later</td>
            </tr>
          </tbody>
        </table>

        <h2>How it works (Typical flow)</h2>
        <p>Common resolution path for a browser opening a website:</p>
        <ol>
          <li>The client checks local caches (OS, browser, application).</li>
          <li>If not cached, it queries a configured recursive resolver (often UDP/53).</li>
          <li>The resolver checks its cache; if needed it queries authoritative servers via the DNS hierarchy.</li>
          <li>The resolver returns an answer (A/AAAA/CNAME chain, etc.) with TTL values.</li>
          <li>The client uses the returned IP address to open TCP/TLS connections to the service.</li>
        </ol>
        <ul>
          <li><strong>Caching matters:</strong> Many “DNS issues” are really stale caches or inconsistent TTL behavior.</li>
          <li><strong>Fallback to TCP:</strong> Large responses or truncated UDP replies may trigger TCP retry.</li>
        </ul>

        <h2>How it looks in Wireshark</h2>
        <p><strong>Display filter example:</strong></p>
        <pre class="ws-filter"><code>dns</code></pre>

        <p><strong>What you typically see:</strong></p>
        <ul>
          <li>Standard query/response pairs with matching Transaction ID.</li>
          <li>Query names (QNAME) and response codes (NoError, NXDOMAIN).</li>
          <li>Answer records (A/AAAA/CNAME), TTL, and additional records (like EDNS0 or OPT records).</li>
        </ul>
        <p>
          <strong>Quick read tip:</strong> If responses look incomplete, check for truncation (TC flag) and whether the client
          retries over TCP. Many “mystery” failures are just a client that never successfully performs the TCP fallback.
        </p>

        <h2>Common issues &amp; troubleshooting hints</h2>

        <h3>1) NXDOMAIN vs “no data” confusion</h3>
        <dl class="issue">
          <dt>Symptom</dt>
          <dd>
            Name resolution fails for a specific record type (for example, AAAA) but not others. Some applications work while
            others that prefer IPv6 fail, or logs show repeated attempts to resolve the same name.
          </dd>

          <dt>Likely cause</dt>
          <dd>
            The domain itself exists, but the requested record type is missing (“no data”), or resolver policies differ by type
            (DNS64, filtering, or split-horizon design). From the application’s perspective this can look similar to a full failure.
          </dd>

          <dt>How to confirm</dt>
          <dd>
            Inspect the response code (NoError vs NXDOMAIN) and the answer section. Compare A vs AAAA queries for the same name
            and check whether the resolver returns synthetic or filtered answers for particular types or clients.
          </dd>
        </dl>

        <h3>2) Slow browsing due to DNS latency</h3>
        <dl class="issue">
          <dt>Symptom</dt>
          <dd>
            First page load is slow while subsequent loads are fast. Users may describe this as “the first click hangs, then
            everything is fine” or see delays before any TCP connection is attempted.
          </dd>

          <dt>Likely cause</dt>
          <dd>
            Cache misses causing recursive resolution, timeouts to an upstream resolver, or path issues between the resolver
            and authoritative servers. Misconfigured forwarders or overloaded resolvers can add hundreds of milliseconds or more.
          </dd>

          <dt>How to confirm</dt>
          <dd>
            Compare query and response timestamps in the capture. Look for repeated queries, retries, or long gaps before responses.
            Check whether queries are sent to multiple resolvers, and whether one of them consistently responds slower or times out.
          </dd>
        </dl>

        <h3>3) DNS hijacking / filtering</h3>
        <dl class="issue">
          <dt>Symptom</dt>
          <dd>
            Clients receive unexpected IP addresses, blocked domains resolve to “walled garden” hosts, or search pages appear
            instead of standard NXDOMAIN errors. Security tools may also flag connections to suspicious or unwanted endpoints.
          </dd>

          <dt>Likely cause</dt>
          <dd>
            Captive portals, ISP or enterprise filtering, malware altering DNS settings, or misconfigured DNS forwarding.
            Some environments intentionally rewrite NXDOMAIN to a search or advertising page, which can confuse troubleshooting.
          </dd>

          <dt>How to confirm</dt>
          <dd>
            Compare answers from multiple resolvers (local vs public) for the same names. Look for unusual TTL values, private
            IP answers for public domains, or consistent rewriting of NXDOMAIN into synthetic responses. Verify the client’s
            configured DNS servers and whether encrypted DNS is in use.
          </dd>
        </dl>

        <h2>Security notes (if relevant)</h2>
        <p>
          Classic DNS is usually unencrypted and can be observed or modified on the path. DNSSEC can provide authenticity for
          signed zones, but deployment and validation vary. Encrypted DNS transports (DoT/DoH) protect privacy and integrity
          on the local path, but they also reduce visibility for network troubleshooting unless you capture at the endpoint
          before encryption.
        </p>

        <h2>Related pages (internal links)</h2>
        <ul>
          <li><a href="/dictionary.html">Back to Dictionary Index</a></li>
          <li>
            <a href="/fields.html">Key fields (Field Index)</a>
            <span class="hint">— planned: DNS flags/rcode (Soon), DNS resource record fields (Soon)</span>
          </li>
          <li>
            <a href="/topics.html">Related topics (Topic Index)</a>
            <span class="hint">— planned: NXDOMAIN vs NODATA (Soon), DNS cache behavior (Soon)</span>
          </li>
        </ul>

        <!--
        Done checklist (Dictionary P0 v1.3)
        - Safe-scope CSS: YES (all selectors under .content)
        - data-ads: on
        - 1000–1600 words: verify before publishing
        - H1 = 1: yes
        - H2 >= 6: yes
        - Table >= 1: yes
        - Lists >= 2: yes
        - Internal links >= 3: yes (dictionary/fields/topics)
        - Soon is not linked: yes
        - Wireshark filter uses <pre class="ws-filter">: yes
        - Issues use <dl class="issue"> blocks: yes
        - AdSense script embedded here: NO (required)
        -->
      </article>

      <!-- Ad slot (bottom) -->
      <div class="ad">Ad slot (dictionary-bottom)</div>

    </section>
  </main>

  <footer class="footer">
    <div class="footer-inner">
      <div>
        <a href="/legal/privacy.html">Privacy</a>
        <a href="/legal/terms.html">Terms</a>
        <a href="/about.html">About</a>
        <a href="/contact.html">Contact</a>
      </div>
      <div class="copyright">© Network Packet Dictionary</div>
    </div>
  </footer>

  <script src="/assets/js/site.js"></script>
</body>
</html>
