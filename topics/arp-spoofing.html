<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />

  <title>ARP Spoofing (Man-in-the-Middle) | Network Packet Dictionary</title>
  <meta name="description" content="Learn how to recognize ARP spoofing in captures, separate normal ARP changes from attacks, and decide what to check next on the local segment." />
  <meta name="robots" content="index,follow" />

  <link rel="stylesheet" href="/assets/css/styles.css" />

  <!-- Topics P0 v1.0: SAFE SCOPE (ONLY inside <article class="content">) -->
  <style>
    /* Wireshark filter block (scoped) */
    .content pre.ws-filter{
      margin:0.4em 0 1em;
      padding:0.6em 0.8em;
      border-radius:8px;
      background:rgba(0,0,0,0.06);
      border:1px solid rgba(0,0,0,0.10);
      overflow-x:auto;
    }
    .content pre.ws-filter code{
      background:none;
      padding:0;
      border:none;
      font-size:0.95em;
      user-select:text;
      font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;
    }

    /* Sub-section emphasis (scoped) */
    .content h3{
      font-size:1.2em;
      font-weight:900;
      margin-top:1.6em;
      margin-bottom:0.45em;
    }

    /* Issue-style blocks for “success/failure” (scoped) */
    .content dl.issue{
      margin:0.6em 0 1.4em;
      padding:0.9em 1em;
      border-radius:10px;
      background:rgba(0,0,0,0.04);
      border:1px solid rgba(0,0,0,0.08);
    }
    .content dl.issue dt{
      font-weight:900;
      margin-top:0.65em;
    }
    .content dl.issue dt:first-child{ margin-top:0; }
    .content dl.issue dd{
      margin:0.2em 0 0.45em;
      opacity:0.95;
      line-height:1.65;
    }
    .content dl.issue dd + dt{ margin-top:0.75em; }

    /* Ordered list emphasis (scoped) */
    .content ol{ margin:0.6em 0 1.2em; padding-left:1.4em; }
    .content ol li{ margin:0.4em 0; line-height:1.6; }
    .content ol li::marker{ font-weight:900; }
  </style>

  <!-- v1.0 rule: AdSense script must NOT be embedded in topics pages -->
</head>

<body data-ads="on">
  <header class="header">
    <div class="header-inner">
      <a class="brand" href="/">
        <div class="logo"></div>
        <div>
          <div class="brand-title">Network Packet Dictionary</div>
        </div>
      </a>
      <nav class="nav" aria-label="Site">
        <a href="/dictionary.html">Dictionary</a>
        <a href="/fields.html">Fields</a>
        <a href="/topics.html">Topics</a>
        <a href="/tools.html">Tools</a>
        <a href="/about.html">About</a>
      </nav>
    </div>
  </header>

  <main class="wrap">
    <section class="card">

      <div class="ad">Ad slot (topics-top)</div>

      <article class="content">
        <h1>ARP Spoofing (Man-in-the-Middle)</h1>

        <h2>The scenario (Why you care)</h2>
        <p>
          Someone reports “the network feels weird.” HTTPS sessions occasionally reset, DNS answers look inconsistent, a laptop can reach the
          internet but internal services intermittently fail, or a security team sees suspicious lateral movement. On a flat Ethernet segment,
          one of the fastest ways to disrupt or intercept traffic is to manipulate <strong>ARP (Address Resolution Protocol)</strong>, because ARP
          is how hosts map an IPv4 address to a destination MAC address on the local link.
        </p>
        <p>
          <strong>ARP spoofing</strong> (also called ARP poisoning) occurs when a device sends forged ARP messages so that other hosts learn an
          incorrect IP-to-MAC mapping. Often the attacker tries to become a <strong>man-in-the-middle</strong> by convincing victims that the
          gateway’s IP address belongs to the attacker’s MAC, and convincing the gateway that the victim’s IP address belongs to the attacker’s MAC.
          Once traffic is redirected through the attacker, they can sniff, modify, or selectively block packets. The challenge in packet analysis is
          separating a real attack from normal ARP churn (DHCP renewals, device moves, failovers, VM mobility).
        </p>

        <h2>What “good” looks like (Success pattern)</h2>
        <dl class="issue">
          <dt>What you see</dt>
          <dd>
            ARP requests (“Who has X? Tell Y”) are followed by a single matching ARP reply from the expected device. The mapping for
            key IPs (default gateway, DNS server, printers) is stable over time. If a mapping changes, it has an obvious operational cause
            like a gateway failover, an interface move, or a short burst during address reassignment.
          </dd>

          <dt>Why it happens</dt>
          <dd>
            ARP is local-link discovery. Hosts cache ARP results to avoid flooding the network. Occasional ARP broadcasts are normal:
            a host boots, the ARP cache expires, a new IP appears, or the gateway announces itself. In healthy networks, ARP traffic is
            relatively low volume and consistent with real device ownership.
          </dd>

          <dt>Key clue</dt>
          <dd>
            The gateway IP consistently resolves to the same MAC (or to a known HA pair), and ARP replies match the request pattern
            rather than appearing as unsolicited “corrections” from random devices.
          </dd>
        </dl>

        <h2>What goes wrong (Failure pattern)</h2>
        <dl class="issue">
          <dt>What you see</dt>
          <dd>
            Multiple different MAC addresses claim ownership of the same IPv4 address, especially the default gateway. You may see repeated
            ARP replies (often unsolicited) advertising “X is at AA:AA:AA...” followed quickly by “X is at BB:BB:BB...”. Endpoints flip-flop
            between mappings, and application traffic becomes unstable: connections reset, TLS sessions renegotiate, or traffic disappears when
            sent to the wrong MAC.
          </dd>

          <dt>Likely causes</dt>
          <dd>
            A malicious actor is poisoning ARP caches to intercept traffic, or a misconfigured device is incorrectly answering for an IP it does
            not own (duplicate IP, accidental proxy ARP behavior, virtualization bridge confusion). In some environments, HA gateways can legitimately
            move a virtual MAC during failover, but those changes should be infrequent and aligned with an outage or failover event.
          </dd>

          <dt>Key clue</dt>
          <dd>
            You see <strong>unsolicited ARP replies</strong> (gratuitous-style announcements) repeatedly changing the gateway IP’s MAC, and the changes
            correlate with broken or intercepted sessions on the same segment.
          </dd>
        </dl>

        <h2>Signals &amp; decision table</h2>
        <p>
          Use this table to decide whether you are looking at normal ARP behavior, a benign topology event, or a likely poisoning scenario.
          The fastest checks are: “Does one IP map to multiple MACs?” and “Are ARP replies happening without corresponding requests?”
        </p>
        <table>
          <thead>
            <tr>
              <th>Signal you see</th>
              <th>What it suggests</th>
              <th>What to check next</th>
              <th>Related field/protocol</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Gateway IP maps to one stable MAC over time</td>
              <td>Normal ARP behavior</td>
              <td>Baseline the expected gateway MAC; keep it as a reference for future incidents</td>
              <td>ARP sender MAC/IP</td>
            </tr>
            <tr>
              <td>Same IP claimed by two MACs within short time window</td>
              <td>Potential spoofing or duplicate IP</td>
              <td>Check whether both MACs are on the same VLAN; look for simultaneous traffic from both claimants</td>
              <td>ARP, Ethernet src MAC</td>
            </tr>
            <tr>
              <td>Unsolicited ARP replies frequently “updating” gateway mapping</td>
              <td>Poisoning attempt (MITM) or noisy device</td>
              <td>Identify the sender MAC of the unsolicited replies; compare to known infrastructure inventory</td>
              <td>ARP reply (is-at), gratuitous ARP</td>
            </tr>
            <tr>
              <td>ARP storm / high ARP rate from one host</td>
              <td>Attack tooling, scanning, or broken NIC/driver</td>
              <td>Correlate ARP bursts with connection resets; isolate the single talker producing the flood</td>
              <td>ARP opcode, rate</td>
            </tr>
            <tr>
              <td>Mapping changes align with gateway failover event</td>
              <td>Benign HA behavior</td>
              <td>Confirm expected virtual MAC behavior; ensure failover is the only time mapping changes</td>
              <td>ARP, gateway redundancy</td>
            </tr>
            <tr>
              <td>Victim traffic appears to go to attacker MAC (L2), while IP dst stays gateway</td>
              <td>Classic MITM redirection</td>
              <td>Inspect Ethernet destination MAC on victim outbound frames; confirm mismatch vs expected gateway MAC</td>
              <td>Ethernet dst MAC vs IP dst</td>
            </tr>
          </tbody>
        </table>

        <h2>How it looks in Wireshark</h2>
        <p><strong>Display filter example:</strong></p>
        <pre class="ws-filter"><code>arp</code></pre>
        <ul>
          <li>
            Look at <strong>ARP opcode</strong> (request vs reply) and the sender/target IP/MAC pairs. The key is consistency:
            “Who claims to own the gateway IP?”
          </li>
          <li>
            In a local capture, compare <strong>Ethernet destination MAC</strong> of normal outbound traffic to the expected gateway MAC.
            If the Ethernet dst MAC suddenly changes while the IP destination remains remote, a redirection is likely.
          </li>
          <li>
            Watch for <strong>reply bursts without requests</strong>. Occasional gratuitous ARP can be normal, but repeated unsolicited updates
            for critical IPs are suspicious.
          </li>
        </ul>
        <p><strong>Quick read tip:</strong> Track one critical IP (usually the default gateway) and list every MAC that claims it during the incident window.</p>

        <h2>Fast triage checklist</h2>
        <ol>
          <li><strong>Pick the key IP</strong>: start with the default gateway IP used by affected hosts on that segment.</li>
          <li><strong>Collect claimants</strong>: in the capture window, note every sender MAC that claims “gateway IP is at …”.</li>
          <li><strong>Classify the replies</strong>: are they mostly responses to requests, or unsolicited announcements?</li>
          <li><strong>Correlate with symptoms</strong>: do mapping flips align with resets, DNS anomalies, or traffic blackholes?</li>
          <li><strong>Decide branch</strong>: if one stable MAC (or known HA pair) = likely normal; multiple changing MACs = escalate as spoofing/duplicate IP.</li>
        </ol>

        <h2>Common pitfalls</h2>
        <h3>Assuming any gratuitous ARP is malicious</h3>
        <p>
          Gratuitous ARP can be used for legitimate purposes: announcing an IP after DHCP assignment, updating caches after a MAC change,
          or supporting HA failover. The suspicious pattern is not “a gratuitous ARP exists,” but <strong>repeated</strong> unsolicited replies that
          continuously rewrite critical mappings (especially the gateway) without a corresponding operational event.
        </p>

        <h3>Ignoring VLAN / capture location</h3>
        <p>
          ARP is confined to a broadcast domain. If your capture is taken on a host, you only see ARP on that host’s segment.
          If you capture on a trunk or SPAN incorrectly, you may see partial traffic and draw wrong conclusions.
          When possible, confirm that all observed MACs are truly in the same L2 domain as the victim.
        </p>

        <h3>Confusing proxy ARP and duplicate IP with spoofing</h3>
        <p>
          Some devices legitimately answer ARP on behalf of others (proxy ARP), and duplicate IP configurations can create “two MACs for one IP”
          without an attacker. The practical way to separate them is correlation: if the mapping changes cause session interception or instability,
          treat it as high risk until proven benign. If mapping changes are rare and align with known device behavior, it may be an intended design.
        </p>

        <h2>Related pages (internal links)</h2>
        <ul>
          <li><a href="/topics.html">Back to Topics Index</a></li>
          <li><a href="/dictionary/arp.html">Dictionary: ARP overview</a></li>
          <li><a href="/fields/ipv4-ttl.html">Field: IPv4 TTL</a> <span class="hint">(Often used as a clue when paths or origins change — optional)</span></li>
          <li><a href="/dictionary.html">Dictionary Index</a></li>
        </ul>

        <!--
        Topics P0 v1.0 checklist
        - Safe-scope CSS: YES (all selectors under .content)
        - data-ads: on
        - 700–1200 words: verify before publishing
        - Table >= 1: YES (decision table)
        - Lists: YES (ul + ol)
        - Internal links >= 4: topics + dictionary + field + dictionary index
        - Soon is not linked: yes (text only)
        - Wireshark filter uses <pre class="ws-filter"><code>...</code></pre>: yes
        - AdSense script embedded here: NO
        -->
      </article>

      <div class="ad">Ad slot (topics-bottom)</div>

    </section>
  </main>

  <footer class="footer">
    <div class="footer-inner">
      <div>
        <a href="/legal/privacy.html">Privacy</a>
        <a href="/legal/terms.html">Terms</a>
        <a href="/about.html">About</a>
        <a href="/contact.html">Contact</a>
      </div>
      <div class="copyright">© Network Packet Dictionary</div>
    </div>
  </footer>

  <script src="/assets/js/site.js"></script>
</body>
</html>
